<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ACCT 922 — Final Presentation Poll (Fall 2025)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0f172a0d;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #64748b;
      --brand: #6366f1;
      --brand-weak: #eef2ff;
      --ring: 0 0 0 6px rgba(99,102,241,.15);
      --radius: 18px;
      --shadow: 0 10px 30px rgba(2, 6, 23, .08);
      --maxw: 1100px;
    }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: linear-gradient(180deg, #f8fafc, #eef2f7);
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    /* Page header */
    header.page {
      position: sticky; top: 0; z-index: 10;
      backdrop-filter: blur(6px);
      background: rgba(255,255,255,.75);
      border-bottom: 1px solid #e5e7eb;
    }
    .nav {
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 16px 18px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .dot {
      width: 10px; height: 10px; border-radius: 9999px; background: var(--brand);
      box-shadow: 0 0 0 6px rgba(99,102,241,.15);
    }
    h1 { font-size: 18px; margin: 0; font-weight: 600; letter-spacing: .2px; }
    .wrap {
      max-width: var(--maxw);
      margin: 22px auto;
      padding: 0 18px 28px;
      display: grid;
      gap: 22px;
    }
    @media (min-width: 980px) {
      .wrap { grid-template-columns: 1fr 1fr; }
    }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid #eaeef3;
    }
    .card > header {
      background: linear-gradient(0deg, #fff, #fff);
      border: none;
      padding: 16px 18px;
    }
    .card h2 { margin: 0; font-size: 16px; font-weight: 600; }
    .content { padding: 16px 18px 20px; }
    .meta { font-size: 12px; color: var(--muted); margin-top: 6px; }
    .toolbar { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
    .btn {
      cursor: pointer; border: 0; padding: 10px 12px; border-radius: 12px;
      background: var(--brand-weak); color: var(--text); font-weight: 500;
      transition: transform .06s ease, box-shadow .1s ease, background .2s ease;
    }
    .btn:hover { transform: translateY(-1px); box-shadow: var(--shadow); }
    .btn:active { transform: translateY(0); box-shadow: none; }
    .chartShell {
      background: #fbfbfe; border: 1px solid #eceef8; border-radius: 14px;
      padding: 14px; min-height: 280px;
    }
    #liveChart { width: 100%; height: auto; display: block; border-radius: 10px; }
    iframe {
      width: 100%; border: 0; background: #fff; border-radius: 14px;
      min-height: 1200px;
    }
    .footNote { padding: 10px 18px 16px; font-size: 12px; color: var(--muted); }
    .lede { max-width: var(--maxw); margin: 12px auto 0; padding: 0 18px; color: var(--muted); }
  </style>
</head>
<body>
  <header class="page">
    <div class="nav">
      <div class="dot" aria-hidden="true"></div>
      <h1>ACCT 922 — Final Presentation Poll</h1>
    </div>
  </header>

  <p class="lede">
    Please select your preferred presentation date. Presentations are
    <strong>10 minutes</strong>, followed by <strong>5 minutes</strong> of Q&amp;A.
    Dates: <strong>Monday, November 17</strong> or <strong>Wednesday, November 19</strong>.
    Choose <strong>one</strong> option below. If both dates work, select “Either date works.”
  </p>

  <main class="wrap">
    <!-- Live chart -->
    <section class="card">
      <header><h2>Live Results</h2></header>
      <div class="content">
        <div class="toolbar">
          <button id="refreshBtn" class="btn" title="Force refresh">Refresh chart</button>
          <span class="meta" id="lastRef">Last refresh: never</span>
        </div>
<div class="chartShell">
  <canvas id="resultsChart"></canvas>
</div>

        </div> 
    </section>

    <!-- Form -->
    <section class="card">
      <header><h2>Survey</h2></header>
      <div class="content">
        <iframe
          src="https://docs.google.com/forms/d/e/1FAIpQLSdV8foHKr1TfV8oSOcROai4MwfXtM5YzxrVgR-6EIDIHKZF2A/viewform?embedded=true"
          allowfullscreen
        >Loading…</iframe>
      </div>
      <div class="footNote">Tip: if your form is longer/shorter, adjust the iframe height in the HTML.</div>
    </section>
  </main>

  <script>
  const frame = document.getElementById('liveChartFrame');
  const lastRef = document.getElementById('lastRef');

  function refreshChart() {
    const u = new URL(frame.src);
    u.searchParams.set('cb', Date.now()); // cache-buster
    frame.src = u.toString();
    lastRef.textContent = 'Last refresh: ' + new Date().toLocaleTimeString();
  }

  document.getElementById('refreshBtn').addEventListener('click', refreshChart);
  setInterval(refreshChart, 30000);
  window.addEventListener('load', () => setTimeout(refreshChart, 300));
</script>

  
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSNunski5yKvFXexjpUrN7gPT5tQPcMiIUaaq_-wm3GjqAQTrrupDw1nK_oxOMQF6xcR_Dn0OWzEREq/pub?gid=1250869048&single=true&output=csv';
  const lastRef = document.getElementById('lastRef');
  const btn = document.getElementById('refreshBtn');

  let chart;

  async function fetchCSV(url) {
    const u = new URL(url);
    u.searchParams.set('cb', Date.now()); // bust any proxies/CDNs
    const res = await fetch(u.toString(), { cache: 'no-store' });
    const text = await res.text();
    return text;
  }

  function parseCSV(text) {
    // Expecting headers like: Option, Votes
    const lines = text.trim().split(/\r?\n/);
    const [header, ...rows] = lines;
    const cols = header.split(',');
    const idxLabel = cols.findIndex(c => /option/i.test(c));
    const idxValue = cols.findIndex(c => /vote|count|responses?/i.test(c));
    const labels = [];
    const values = [];
    rows.forEach(line => {
      const parts = line.split(',');
      if (parts.length >= 2) {
        labels.push(parts[idxLabel >= 0 ? idxLabel : 0].replace(/^"|"$/g,''));
        values.push(Number(parts[idxValue >= 0 ? idxValue : 1]) || 0);
      }
    });
    return { labels, values };
  }

  function renderChart(data) {
    const ctx = document.getElementById('resultsChart').getContext('2d');
    if (chart) {
      chart.data.labels = data.labels;
      chart.data.datasets[0].data = data.values;
      chart.update();
      return;
    }
    chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: data.labels,
        datasets: [{ label: 'Responses', data: data.values }]
      },
      options: {
        responsive: true,
        animation: false,
        plugins: {
          legend: { display: false },
          tooltip: { mode: 'index', intersect: false }
        },
        scales: {
          y: { beginAtZero: true, ticks: { precision: 0 } }
        }
      }
    });
  }

  async function refreshChart() {
    try {
      const csv = await fetchCSV(CSV_URL);
      const parsed = parseCSV(csv);
      renderChart(parsed);
      lastRef.textContent = 'Last refresh: ' + new Date().toLocaleTimeString();
    } catch (e) {
      lastRef.textContent = 'Last refresh failed at ' + new Date().toLocaleTimeString();
      // Optional: console.error(e);
    }
  }

  btn.addEventListener('click', refreshChart);
  let timer = setInterval(refreshChart, 10000);
  document.addEventListener('visibilitychange', () => {
    if (!document.hidden) refreshChart();
  });
  window.addEventListener('load', () => setTimeout(refreshChart, 300));
</script>
  
  </main>
</body>
</html>

